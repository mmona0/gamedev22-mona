<!DOCTYPE html>
<html>
  <head>
    <style>
      #man {
        position: absolute;
        width: 50px;
        height: 50px;
      }
      
      .zombie {
        position: absolute;
        width: 50px;
        height: 50px;
      }
    </style>
  </head>
  <body>
    <img id="man" src="https://st.depositphotos.com/1292351/3183/v/950/depositphotos_31836279-stock-illustration-illustration-of-cartoon-soldier-with.jpg">
    <img class="zombie" src="https://www.pinclipart.com/picdir/big/530-5309489_cartoon-zombie-png-clipart.png">
    <img class="zombie" src="https://www.pinclipart.com/picdir/big/530-5309489_cartoon-zombie-png-clipart.png">
    <img class="zombie" src="https://www.pinclipart.com/picdir/big/530-5309489_cartoon-zombie-png-clipart.png">
<!-- add more zombies here -->

<button id="start-button">Start</button>
<p id="score"></p>

<script>
  // Constants
  const MAN_SPEED = 110; // pixels per second
  const ZOMBIE_SPEED = 50; // pixels per second
  const ZOMBIE_SIZE = 50; // width and height of zombies
  const RELOAD_TIME = 5000;
  const SHOOT_DELAY = 200; // time between shots (in milliseconds)

  // Get DOM elements
  const man = document.getElementById("man");
  const zombies = document.querySelectorAll(".zombie");
  const startButton = document.getElementById("start-button");
  const scoreElement = document.getElementById("score");

  // Game variables
  let score = 0;
  let gameStarted = false;
  let lastShot = 0;

  // Move the man based on mouse position
  function moveMan(event) {
    man.style.left = event.clientX - (man.width / 2) + "px";
    man.style.top = event.clientY - (man.height / 2) + "px";
  }

  // Move the zombies towards the man
  function moveZombies() {
    for (let i = 0; i < zombies.length; i++) {
      let zombiesRect = zombies[i].getBoundingClientRect();
      let manRect = man.getBoundingClientRect();
      
      // Calculate the distance between the zombies and the man
      let xDistance = manRect.x - zombiesRect.x;
      let yDistance = manRect.y - zombiesRect.y;
      let distance = Math.sqrt(xDistance * xDistance + yDistance * yDistance);

      // Calculate the direction of movement for the zombies
      let xDirection = xDistance / distance;
      let yDirection = yDistance / distance;

      // Move the zombies
      zombies[i].style.left = zombiesRect.x + xDirection * ZOMBIE_SPEED + "px";
      zombies[i].style.top = zombiesRect.y + yDirection * ZOMBIE_SPEED + "px";

      // Check collision
      if (Math.abs(xDistance) < ZOMBIE_SIZE && Math.abs(yDistance) < ZOMBIE_SIZE) {
        gameOver();
      }
    }
    // schedule next move of zombies
    requestAnimationFrame(moveZombies);
  }

  // when the game is over
  function gameOver() {
    alert("Game over! Your score is " + score);
    setTimeout(function() {
      location.reload();
    }, RELOAD_TIME);
  }

  // shoot function
  function shoot() {
    if (Date.now() - lastShot < SHOOT_DELAY) {
      return;
    }
    lastShot = Date.now();

    let closestZombie = null;
    let closestDistance = Infinity;

    // Find the closest zombies
    for (let i = 0; i < zombies.length; i++) {let zombiesRect = zombies[i].getBoundingClientRect();
let manRect = man.getBoundingClientRect();
let xDistance = manRect.x - zombiesRect.x;
let yDistance = manRect.y - zombiesRect.y;
let distance = Math.sqrt(xDistance * xDistance + yDistance * yDistance);


      if (distance < closestDistance) {
        closestZombie = zombies[i];
        closestDistance = distance;
      }
    }

    // If a zombie was found, shoot it
    if (closestZombie) {
      closestZombie.style.left = "0px";
      closestZombie.style.top = "0px";
      score += 100;
      scoreElement.innerHTML = "Score: " + score;
    }
  }

  // Start the game when the start button is clicked
  startButton.addEventListener("click", () => {
    if(!gameStarted){
      gameStarted = true;
      moveZombies();
      document.onmousemove = moveMan;
    }
  });

  // handle shooting on mouse click
  document.addEventListener("mousedown", function(event) {
    if(event.target.id === "man"){
      shoot();
    }
  });
</script>
  </body>
</html>
