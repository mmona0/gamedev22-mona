<!DOCTYPE html>
version 3.19
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pferdedecken leicht gemacht</title>
    <style>
        /* Stildefinitionen */
        * { box-sizing: border-box; }
        
        .row::after { content: ""; clear: both; display: table; }
        
        [class*="col-"] { float: left; padding: 15px; }
        .col-1 { width: 8.33%; }
        .col-2 { width: 16.66%; }
        .col-3 { width: 25%; }
        .col-4 { width: 33.33%; }
        .col-5 { width: 41.66%; }
        .col-6 { width: 50%; }
        .col-7 { width: 58.33%; }
        .col-8 { width: 66.66%; }
        .col-9 { width: 75%; }
        .col-10 { width: 83.33%; }
        .col-11 { width: 91.66%; }
        .col-12 { width: 100%; }
        
        html { font-family: "Lucida Sans", sans-serif; }
        
        .header { background-color: #008000; color: #ffffff; padding: 15px; }
        
        table { font-family: Arial, Helvetica, sans-serif; border-collapse: collapse; width: 100%; }
        td, th { border: 1px solid #ddd; padding: 8px; }
        tr:nth-child(even) { background-color: #f2f2f2; }
        th { background-color: #008000; color: white; text-align: left; padding: 12px; }

/* Grundstil für das Menü */
#menu {
    background-color: #007bff; /* Blau */
    color: white;
    width: 200px;
    padding: 10px;
    box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);
    display: none; /* Standardmäßig ausgeblendet */
    position: relative; /* Im normalen Fluss der Seite */
}

/* Menü sichtbar machen */
#menu.open {
    display: block;
}

/* Menü-Button */
#menuToggle {
    background-color: #0056b3;
    color: white;
    border: none;
    padding: 10px 15px;
    cursor: pointer;
    font-size: 18px;
    margin-bottom: 10px;
    transition: background-color 0.3s ease;
}

#menuToggle:hover {
    background-color: #003d80;
}

/* Menü-Optionen */
#menu ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

#menu ul li {
    margin: 10px 0;
}

#menu ul li a {
    text-decoration: none;
    color: white;
    font-size: 16px;
    transition: color 0.2s;
}

#menu ul li a:hover {
    color: #cce7ff;
}

    </style>
</head>
<body>
<div class="header">
    <h1>Pferdedecken leicht gemacht</h1>
    <button id="menuToggle">☰ Menü</button>
    <div id="menu" class="col-3">
        <ul>
            <li><a href="#option1">Option 1</a></li>
            <li><a href="#option2">Option 2</a></li>
            <li><a href="#option3">Option 3</a></li>
        </ul>
    </div>
</div>

        <div class="col-9">
            <form name="form1" id="pferdeForm">
                <!-- Fellzustand -->
                <table>
                    <tr>
                        <th>Wie ist der momentane Fellzustand Ihres Pferdes?</th>
                    </tr>
                    <tr>
                        <td>
                            <input type="radio" id="dick" name="fellzustand" value="dick">
                            <label for="dick">Dichtes Winterfell (häufig vorkommend bei Kaltblütern)</label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input type="radio" id="dünn" name="fellzustand" value="dünn">
                            <label for="dünn">Dünnes Winterfell (häufig vorkommend bei Warmblütern)</label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input type="radio" id="geschoren" name="fellzustand" value="geschoren">
                            <label for="geschoren">Geschoren</label>
                        </td>
                    </tr>
                </table>

                <!-- Haltung -->
                <table>
                    <tr>
                        <th>Wie steht Ihr Pferd hauptsächlich?</th>
                    </tr>
                    <tr>
                        <td>
                            <input type="radio" id="box" name="haltung" value="box">
                            <label for="box">In der Box</label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input type="radio" id="paddock" name="haltung" value="paddock">
                            <label for="paddock">Draußen auf dem Paddock</label>
                        </td>
                    </tr>
                </table>

                <!-- BCS -->
                <table>
                    <tr>
                        <th>Wie ist der BCS (Body Conditioning Score) Ihres Pferdes? <br>(Der BCS beschreibt den Körperzustand eines Pferdes. Hier reicht eine grobe Einschätzung.)</th>
                    </tr>
                    <tr>
                        <td>
                            <input type="radio" id="gesund" name="bcs" value="gesund">
                            <label for="gesund">Ein BCS größer als 3; Ein gesundes oder übergewichtiges Pferd</label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input type="radio" id="dünn" name="bcs" value="dünn">
                            <label for="dünn">Ein BCS von 3 oder kleiner; Ein dünnes, untergewichtiges Pferd</label>
                        </td>
                    </tr>
                </table>

                <!-- Training -->
                <table>
                    <tr>
                        <th>Wie viel ist Ihr Pferd aktuell im Training?</th>
                    </tr>
                    <tr>
                        <td>
                            <input type="radio" id="viel" name="training" value="viel">
                            <label for="viel">Mein Pferd wird viel und regelmäßig trainiert.</label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input type="radio" id="wenig" name="training" value="wenig">
                            <label for="wenig">Mein Pferd wird nur ab und zu oder gar nicht trainiert.</label>
                        </td>
                    </tr>
                </table>

                <!-- Buttons -->
                <button type="button" onclick="getLocation()">Absenden</button>
                <input type="reset" value="Zurücksetzen">
            </form>

            <p>Dein Pferd trägt am besten:</p>
            <p id="ergebnis"></p>
            <p id="output"></p>
            <p id="fehler"></p>
            <div id="manuell"></div>
        </div>
    </div>

    <!-- Scripts -->
    //Menü 
    <script>
   document.getElementById('menuToggle').addEventListener('click', function () {
    const menu = document.getElementById('menu');
    menu.classList.toggle('open');
});


        
        // Globale Variablen
let temp, apparentTemp, witterungCode, witterungDescription;

// Hauptfunktion zum Abrufen der Geolokation
function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(fetchWeather, handleError);
    } else {
        showError("Geolocation wird von diesem Browser nicht unterstützt.");
        manuelleEingabe();
    }
}

// Wetterdaten abrufen
function fetchWeather(position) {
    const latitude = position.coords.latitude;
    const longitude = position.coords.longitude;
    const url = `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current_weather=true&hourly=apparent_temperature&timezone=auto&lang=de`;

    fetch(url)
        .then(response => response.json())
        .then(data => {
            if (data.current_weather && data.hourly) {
                temp = data.current_weather.temperature; // Aktuelle Temperatur
                apparentTemp = data.hourly.apparent_temperature[0]; // Gefühlte Temperatur
                witterungCode = data.current_weather.weathercode;
                witterungDescription = getWeatherDescription(witterungCode);

                document.getElementById('output').innerHTML = `
                    Aktuelle Temperatur: ${temp}°C<br>
                    Gefühlte Temperatur: ${apparentTemp}°C<br>
                    Witterung: ${witterungDescription}`;
                
                auswerten();
            } else {
                showError("Fehler beim Abrufen der Wetterdaten.");
            }
        })
        .catch(error => {
            console.error("API-Fehler:", error);
            showError("Fehler bei der Wetter-API.");
            manuelleEingabe();
        });
}

// Fehler bei der Standortabfrage behandeln
function handleError(error) {
    const fehlerText = {
        1: "Standortberechtigung wurde abgelehnt.",
        2: "Standort konnte nicht ermittelt werden.",
        3: "Zeitüberschreitung bei der Standortermittlung."
    };
    showError(fehlerText[error.code] || "Unbekannter Fehler.");
    manuelleEingabe();
}

// Witterungsbeschreibung basierend auf Codes abrufen
function getWeatherDescription(code) {
    const descriptions = {
        0: "Klarer Himmel",
        1: "Hauptsächlich klar",
        2: "Teilweise bewölkt",
        3: "Bewölkt",
        45: "Nebel",
        48: "Reifnebel",
        51: "Leichter Nieselregen",
        53: "Moderater Nieselregen",
        55: "Starker Nieselregen",
        61: "Leichter Regen",
        63: "Moderater Regen",
        65: "Starker Regen",
        71: "Leichter Schneefall",
        73: "Moderater Schneefall",
        75: "Starker Schneefall",
        80: "Leichte Regenschauer",
        81: "Moderate Regenschauer",
        82: "Starke Regenschauer",
        95: "Gewitter",
        96: "Gewitter mit leichtem Hagel",
        99: "Gewitter mit starkem Hagel"
    };
    return descriptions[code] || "Unbekannte Witterung";
}

// Manuelle Eingabe für Standort anbieten
function manuelleEingabe() {
    const container = document.getElementById('manuell');
    if (document.getElementById('standortEingabe')) return;

    const input = document.createElement('input');
    input.type = 'text';
    input.id = 'standortEingabe';
    input.placeholder = 'Standort eingeben';

    const button = document.createElement('button');
    button.textContent = 'Absenden';
    button.onclick = () => {
        const standort = input.value.trim();
        if (standort) getTemperatureForLocation(standort);
    };

    container.appendChild(input);
    container.appendChild(button);
}

// Temperatur basierend auf manuellem Standort abrufen
function getTemperatureForLocation(location) {
    const geocodeUrl = `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(location)}&format=json&addressdetails=1&limit=1`;

    fetch(geocodeUrl)
        .then(response => response.json())
        .then(data => {
            if (data.length > 0) {
                const { lat, lon } = data[0];
                fetchWeather({ coords: { latitude: lat, longitude: lon } });
            } else {
                showError("Standort konnte nicht gefunden werden.");
            }
        })
        .catch(error => {
            console.error("Geocoding-Fehler:", error);
            showError("Fehler bei der Geocoding-API.");
        });
}

// Formularwerte auswerten
function auswerten() {
    const Fellzustand = getFormValue("fellzustand");
    const Haltung = getFormValue("haltung");
    const BCS = getFormValue("bcs");
    const Training = getFormValue("training");

    if (!Fellzustand || !Haltung || !BCS || !Training) {
        showError("Bitte alle Felder ausfüllen!");
        return;
    }

    let pferdezustand;

    if (BCS === "gesund") {
        if (Haltung === "box" && Training === "viel") {
            pferdezustand = "A";
        } else if (Haltung === "paddock" && Training === "wenig" && Fellzustand === "dünn") {
            pferdezustand = "C";
        } else {
            pferdezustand = "B";
        }
    } else if (BCS === "dünn" || Fellzustand === "geschoren") {
        pferdezustand = "D";
    }

    deckenangabe(pferdezustand);
}

// Formularwert abrufen
function getFormValue(name) {
    const selected = document.querySelector(`input[name="${name}"]:checked`);
    return selected ? selected.value : null;
}

// Deckenempfehlung anzeigen
function deckenangabe(pferdezustand) {
    const output = document.getElementById('ergebnis');
    if (temp >= 12) {
        output.innerHTML = 'Keine Decke.';
    } else if (temp >= 6 && temp <= 11) {
        if (pferdezustand === "D") {
            output.innerHTML = 'Regendecke mit einer Füllung von 0g.';
        } else if (pferdezustand === "B" || pferdezustand === "C") {
            output.innerHTML = witterungCode > 3 ? 'Keine Decke.' : 'Regendecke mit einer Füllung von 0g.';
        } else {
            output.innerHTML = 'Keine Decke.';
        }
    } else if (temp >= 1 && temp <= 5) {
        output.innerHTML = pferdezustand === "D" || pferdezustand === "C" ?
            'Thermodecke mit einer Füllung von 100g - 150g.' :
            pferdezustand === "B" ? 'Thermodecke mit einer Füllung von 50g-100g.' : 'Stalldecke oder eine Decke von 0g - 50g.';
    } else if (temp >= -5 && temp <= 0) {
        output.innerHTML = pferdezustand === "D" || pferdezustand === "C" ?
            'Thermodecke mit einer Füllung von 300g.' :
            pferdezustand === "B" ? 'Thermodecke mit einer Füllung von 200g.' : 'Thermodecke mit einer Füllung bis 150g.';
    } else {
        output.innerHTML = pferdezustand === "A" ?
            'Thermodecke mit einer Füllung ab 200g.' : 'Thermodecke mit einer Füllung von 300g.';
    }
}

// Fehler anzeigen
function showError(message) {
    document.getElementById('fehler').innerText = message;
}

    </script>
</body>
</html>
